<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>레시피 수정</title>
<link rel="stylesheet" as="style" crossorigin
	href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css" />
<style>
section {
	padding-top: 30px !important;
	padding-bottom: 100px !important;
}

.queen-page-title {
	margin: 50px 0;
	text-align: center;
	font-weight: 500;
}

.choice-menu-img {
	width: 500px;
	margin: 0 auto;
	height: 300px;
	border: 1px solid #eee;
	border-radius: 10px;
	background: #fff;
	overflow: hidden;
}

.choice-menu-img img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.choice-menu-name {
	text-align: center;
	margin: 40px 0;
}

.recipe-regist-box1 {
	width: 100%;
	margin: 30px auto;
	background: rgb(190, 227, 241, 0.1);
	border: 1px solid #bee3f1;
	border-radius: 5px;
	padding: 30px 0;
}

.recipe-regist-box1 table {
	margin: 0 auto;
	border-spacing: 30px 30px;
}

.recipe-regist-box1 table th {
	text-align: left;
	font-weight: 500;
	font-size: 16px;
}

.recipe-regist-box1 input[type="text"] {
	font-family: "Pretendard Variable", Pretendard;
	width: 600px;
	height: 50px;
	border: 1px solid #ececec;
	background: #fff;
	box-sizing: border-box;
	border-radius: 5px;
	padding-left: 10px;
	color: #666;
}

.recipe-regist-box1 select {
	font-family: "Pretendard Variable", Pretendard;
	width: 120px;
	height: 50px;
	border: 1px solid #ececec;
	border-radius: 5px;
	padding: 0 10px;
}

.recipe-regist-box2 {
	width: 100%;
	margin: 30px auto;
	background: rgb(190, 227, 241, 0.1);
	border: 1px solid #bee3f1;
	padding: 30px 0;
	border-radius: 5px;
}

.recipe-regist-box2 table {
	margin: 0 auto;
	border-spacing: 20px 30px;
}

.recipe-regist-box2 table th {
	text-align: left;
	font-weight: 500;
	font-size: 16px;
}

.recipe-regist-box2 select {
	font-family: "Pretendard Variable", Pretendard;
	width: 250px;
	height: 50px;
	border: 1px solid #ececec;
	border-radius: 5px;
	padding: 0 10px;
}

.recipe-regist-box2 input[type="text"] {
	font-family: "Pretendard Variable", Pretendard;
	width: 120px;
	height: 50px;
	border: 1px solid #ececec;
	border-radius: 5px;
	box-sizing: border-box;
	padding-left: 10px;
}

.recipe-regist-box2 .addBtn {
	text-align: center;
}

.recipe-regist-box2 .addBtn img {
	display: inline-block;
	cursor: pointer;
}

.recipe-regist-box2 .ingredient-delete-btn {
	font-size: 16px;
	font-weight: 500;
	cursor: pointer;
	padding: 2px 7px;
	border: 2px solid #F5A47D;
	color: #F5A47D;
	border-radius: 50%;
}

.recipe-regist-box3 {
	width: 100%;
	margin: 30px auto;
	background: rgb(190, 227, 241, 0.1);
	border: 1px solid #bee3f1;
	padding: 30px 0;
	border-radius: 5px;
}

.recipe-regist-box3 h4 {
	padding-left: 155px;
	font-weight: 500;
}

.recipe-regist-box3 table {
	margin: 0 auto;
	border-spacing: 20px 30px;
}

.recipe-regist-box3 table th {
	font-size: 20px;
	font-weight: 400;
	text-align: left;
}

.recipe-regist-box3 textarea {
	font-family: "Pretendard Variable", Pretendard;
	width: 410px;
	height: 100px;
	resize: none;
	border: 1px solid #ececec;
	border-radius: 5px;
	padding: 10px;
	box-sizing: border-box;
}

.recipe-regist-box3 .order-img-text {
	font-size: 20px;
	text-align: center;
}

.recipe-regist-box3 .order-img {
	width: 160px;
	height: 100px;
	border: 1px solid #eee;
	border-radius: 5px;
	overflow: hidden;
	cursor: pointer;
	background: #fff;
}

.recipe-regist-box3 .order-img img {
	width: 100%;
	height: 100%;
	object-fit: cover;
}

.recipe-regist-box3 .addBtn {
	text-align: center;
}

.recipe-regist-box3 .addBtn img {
	display: inline-block;
	cursor: pointer;
}

.recipe-regist-box3 .delete-btn {
	font-size: 16px;
	font-weight: 500;
	cursor: pointer;
	padding: 2px 7px;
	border: 2px solid #F5A47D;
	color: #F5A47D;
	border-radius: 50%;
}

.recipe-regist-box4 {
	width: 100%;
	margin: 30px auto;
	background: rgb(190, 227, 241, 0.1);
	border: 1px solid #bee3f1;
	padding: 30px 0;
	border-radius: 5px;
}

.recipe-regist-box4 table {
	margin: 0 auto;
	border-spacing: 20px 30px;
}

.recipe-regist-box4 table th {
	text-align: left;
	font-weight: 500;
	font-size: 16px;
	text-align: left;
}

.recipe-regist-box4 input[type="text"] {
	font-family: "Pretendard Variable", Pretendard;
	width: 600px;
	height: 50px;
	border: 1px solid #ececec;
	border-radius: 5px;
	box-sizing: border-box;
	padding-left: 10px;
}

.recipe-regist-btns {
	text-align: center;
}

.recipe-regist-btns input[type="submit"] {
	font-family: "Pretendard Variable", Pretendard;
	width: 133px;
	background: #F5A47D;
	border: 1px solid #F5A47D;
	border-radius: 5px;
	color: #fff;
	cursor: pointer;
	padding: 12px 0;
	font-size: 14px;
	box-sizing: border-box;
}

.recipe-regist-btns a {
	display: inline-block;
	width: 133px;
	background: #fff;
	border: 1px solid #F5A47D;
	border-radius: 5px;
	color: #F5A47D;
	cursor: pointer;
	padding: 12px 0;
	font-size: 14px;
	box-sizing: border-box;
}

.recipe-menu-list {
	margin: 20px 0;
}

.recipe-menu-list ul {
	width: 100%;
	display: flex;
	flex-wrap: wrap;
	gap: 10px;
	border: 1px solid #DAC0DE;
	padding: 40px;
	box-sizing: border-box;
	border-radius: 5px;
}

.recipe-menu-list ul li {
	text-align: center;
	padding: 10px;
	cursor: pointer;
}

.recipe-menu-list ul li:hover {
	background: #DAC0DE;
	border-radius: 5px;
}

.selected {
	background: #DAC0DE;
	border-radius: 5px;
}
</style>
</head>
<body>
	<header>
		<th:block th:insert="~{/sub/header.html}"></th:block>
	</header>
	<section>

		<h1 class="queen-page-title">레시피 수정</h1>
		<div class="choice-menu-img">
			<img id="menu-image" src=""
				onerror="this.onerror=null; this.src='/img/imgNone2.png';">
		</div>

		<!-- 레시피를 등록할 메뉴 전체 리스트 -->
		<div class="choice-menu-name">
			<h4>메뉴 선택</h4>
			<div class="recipe-menu-list">
				<ul>
					<th:block th:each="menu : ${list}">
						<li id="recipe-menu-name" th:text="${menu.menuName}"
							th:attr="mcode=${menu.mcode}"
							th:class="${menu.mcode == recipe.mcode ? 'selected' : ''}">
						</li>
					</th:block>
				</ul>
			</div>
		</div>

		<!-- 레시피 수정 폼 -->
		<form id="recipeForm" action="/my/recipe/update" method="post"
			enctype="multipart/form-data">
			<input type="hidden" name="mcode" id="current-mcode"
				th:value="${recipe.mcode}"> <input type="hidden"
				name="rcode" th:value="${recipe.rcode}">
			<div class="recipe-regist-box1">
				<table>
					<tr>
						<th>레시피 제목</th>
						<td><input type="text" name="recipeName"
							th:value="${recipe.recipeName}"></td>
					</tr>
					<tr>
						<th>요리 소개</th>
						<td><input type="text" name="introduce"
							th:value="${recipe.introduce}"></td>
					</tr>
					<tr>
						<th>동영상 주소</th>
						<td><input type="text" name="url" th:value="${recipe.url}"></td>
					</tr>
					<tr>
						<th>카테고리</th>
						<td><select name="category" id="category-sel">
								<option value="">카테고리별</option>
								<option value="국/탕" th:selected="${recipe.category == '국/탕'}">국/탕</option>
								<option value="찜/조림" th:selected="${recipe.category == '찜/조림'}">찜/조림</option>
								<option value="구이" th:selected="${recipe.category == '구이'}">구이</option>
								<option value="찌개/전골" th:selected="${recipe.category == '찌개/전골'}">찌개/전골</option>
								<option value="볶음"
									th:selected="${recipe.category == '볶음'}">볶음</option>
								<option value="디저트" th:selected="${recipe.category == '디저트'}">디저트</option>
								<option value="밥요리"
									th:selected="${recipe.category == '밥요리'}">밥요리</option>
								<option value="면요리"
									th:selected="${recipe.category == '면요리'}">면요리</option>
								<option value="튀김" th:selected="${recipe.category == '튀김'}">튀김</option>
								<option value="기타" th:selected="${recipe.category == '기타'}">기타</option>
						</select></td>
					</tr>
					<tr>
    			<th>테마</th>
    			<td>
    				<select name="theme" id="theme-sel">
    					<option value="">테마별</option>
    					<option value="한식" th:selected="${recipe.theme == '한식'}">한식</option>
    					<option value="중식" th:selected="${recipe.theme == '중식'}">중식</option>
    					<option value="일식" th:selected="${recipe.theme == '일식'}">일식</option>
    					<option value="양식" th:selected="${recipe.theme == '양식'}">양식</option>
    					<option value="분식" th:selected="${recipe.theme == '분식'}">분식</option>
    					<option value="야식/안주" th:selected="${recipe.theme == '야식/안주'}">야식/안주</option>
    					<option value="생일/기념일" th:selected="${recipe.theme == '생일/기념일'}">생일/기념일</option>
    					<option value="다이어트" th:selected="${recipe.theme == '다이어트'}">다이어트</option>
    					<option value="파티" th:selected="${recipe.theme == '파티'}">파티</option>
    					<option value="손님상" th:selected="${recipe.theme == '손님상'}">손님상</option>
    					<option value="아이반찬" th:selected="${recipe.theme == '아이반찬'}">아이반찬</option>
    					<option value="캠핑/피크닉" th:selected="${recipe.theme == '캠핑/피크닉'}">캠핑/피크닉</option>
    					<option value="명절" th:selected="${recipe.theme == '명절'}">명절</option>
    					<option value="기타" th:selected="${recipe.theme == '기타'}">기타</option>
    				</select>
    			</td>
    		</tr>
					<tr>
						<th>인원</th>
						<td><select name="portions" id="portions-sel">
								<option value="0">인원 선택</option>
								<option value="1">1인</option>
								<option value="2">2인</option>
								<option value="3">3인 이상</option>
						</select></td>
					</tr>
				</table>
			</div>

			<div class="recipe-regist-box2">
				<table id="ingredient-table">
					<th:block th:each="ingre, i : ${recipeIngredient}">
						<tr>
							<th>재료 정보</th>
							<td><select name="icode"
								th:id="'ingredient-select-' + ${i.index}"
								th:value="${ingre.icode}">
									<option value="0">재료 이름</option>
									<option th:each="ingredient, i : ${ingredientList}"
										th:value="${ingredient.icode}" th:text="${ingredient.name}"
										th:selected="${ingre.icode == i.index + 1}"></option>
							</select></td>
							<td><input type="text" name="amount" placeholder="수량"
								th:value="${ingre.amount}"></td>
							<td><input type="text" name="type" placeholder="단위(개/g)"
								th:value="${ingre.type}"></td>
							<td><span class="ingredient-delete-btn">X</span></td>
						</tr>
				</table>
				</th:block>
				<div class="addBtn">
					<img src="/img/addBtn.png" id="recipe-ingredient-add">
				</div>
			</div>

			<div class="recipe-regist-box3">
				<h4>요리 순서</h4>
				<table id="recipe-steps">
					<th:block th:each="order, i : ${recipeOrder}">
						<tr>
							<th>Step [[${i.index + 1}]] <input type="hidden"
								name="orderNum" th:value="${i.index + 1}">
							</th>
							<td><textarea name="orderContent"
									placeholder="예) 소고기를 숭덩숭덩 썰어주세요"
									th:text="${order.orderContent}"></textarea></td>
							<td class="order-img">
								<p class="order-img-text"
									th:style="${order.cookingImg != null && !order.cookingImg.isEmpty() ? 'display:none;' : ''}">➕</p>
								<input type="file" name="newCookingImg" accept="image/*"
								style="display: none;"> <input type="hidden"
								name="existingCookingImg" th:value="${order.cookingImg}">
								<img
								th:src="@{${order.cookingImg != null && !order.cookingImg.isEmpty() ? '/uploads/' + order.cookingImg : '/img/imgNone.png'}}"
								th:style="${order.cookingImg != null && !order.cookingImg.isEmpty() ? '' : 'display:none;'}">
							</td>
							<td><span class="delete-btn">X</span></td>
						</tr>
					</th:block>

				</table>
				<div class="addBtn">
					<img src="/img/addBtn.png" id="recipe-order-add">
				</div>
			</div>

			<div class="recipe-regist-box4">
				<table>
					<tr>
						<th>태그</th>
						<td><input type="text" name="tagContent"
							placeholder="예) 한식, 닭볶음탕"
							th:value="${recipeTag != null ? recipeTag.tagContent : ''}">
						</td>
					</tr>
				</table>
			</div>

			<div class="recipe-regist-btns">
				<input type="submit" value="수정"> <a
					th:href="@{/my/recipe/list(mno=${mno})}">취소</a>
			</div>
		</form>
	</section>
	
	<script>
	
	document.getElementById('recipeForm').addEventListener('submit', function(e) {
	    const mcodeInput = document.getElementById('current-mcode');
	    const menuSelectionArea = document.querySelector('.choice-menu-name');
	    
	    if (!mcodeInput.value) {
	        e.preventDefault(); // 폼 제출을 막습니다
	        alert('메뉴를 선택해주세요.');
	        menuSelectionArea.style.border = '2px solid red';
	        menuSelectionArea.scrollIntoView({ behavior: 'smooth' });
	        setTimeout(() => {
	            menuSelectionArea.style.border = '';
	        }, 3000);
	    } else {
	        console.log("Form data:", new FormData(this));
	        // 폼 제출 전에 추가적인 유효성 검사나 데이터 처리를 할 수 있습니다.
	    }
	});
	
	</script>

	<script th:inline="javascript">
    console.log("Recipe data:", /*[[${recipe}]]*/ null);
</script>

	<script th:inline="javascript">
    var ingredientsList = /*[[${ingredientList}]]*/ [];
</script>

	<script th:inline="javascript">

document.addEventListener("DOMContentLoaded", initializeApp);

function initializeApp() {
    loadInitialData();
    setupEventListeners();
    highlightSelectedMenu();
}

function highlightSelectedMenu() {
    const currentMcode = document.getElementById("current-mcode").value;
    const currentMenuItem = document.querySelector(`li[mcode="${currentMcode}"]`);
    if (currentMenuItem) {
        currentMenuItem.classList.add("selected");
    }
}

function loadInitialData() {
	const categorySel = document.getElementById("category-sel");
    const portionsSel = document.getElementById("portions-sel");
    const themeSel = document.getElementById("theme-sel");
    
    // 서버에서 전달받은 데이터를 사용
    const recipeCategory = /*[[${recipe.category}]]*/ '';
    const recipePortions = /*[[${recipe.portions}]]*/ '';
    const recipeTheme = /*[[${recipe.theme}]]*/ '';
    
    if (categorySel && recipeCategory) {
        categorySel.value = recipeCategory;
    }
    
    if (portionsSel && recipePortions) {
        portionsSel.value = recipePortions;
    }
    
    if (themeSel && recipeTheme) {
        themeSel.value = recipeTheme;
    }
    
    console.log("Category:", recipeCategory); // 디버깅을 위한 로그
    console.log("Portions:", recipePortions); // 디버깅을 위한 로그
    console.log("Theme:", recipeTheme); // 디버깅을 위한 로그
    
    loadMenuImage(document.getElementById("current-mcode").value);
    setupOrderImages();
}

function setupEventListeners() {
    document.querySelectorAll('#recipe-menu-name').forEach(menuItem => {
        menuItem.addEventListener("click", handleMenuClick);
    });

    document.getElementById('ingredient-table').addEventListener('change', handleIngredientChange);
    document.getElementById('ingredient-table').addEventListener('click', handleIngredientDelete);

    document.getElementById('recipe-ingredient-add').addEventListener('click', addIngredient);
    document.getElementById('recipe-order-add').addEventListener('click', addRecipeOrder);

    document.getElementById('recipe-steps').addEventListener('click', handleRecipeStepEvents);
}

function handleMenuClick(event) {
	updateSelectedMenu(event.target);
    const mcode = event.target.getAttribute("mcode");
    updateMenuImage(mcode);
    document.getElementById("current-mcode").value = mcode;
}

function updateSelectedMenu(menuItem) {
	const prevSelected = document.querySelector('li.selected');
    if (prevSelected) {
        prevSelected.classList.remove("selected");
    }
    menuItem.classList.add("selected");
}

function updateMenuImage(mcode) {
    fetch(`/getMenuImage?mcode=${mcode}`)
        .then(response => response.json())
        .then(data => {
            const imageUrl = `/uploads/${data.imgurl}`;
            const menuImage = document.getElementById("menu-image");
            menuImage.src = imageUrl;
            menuImage.onerror = () => { menuImage.src = '/img/imgNone2.png'; };
        })
        .catch(error => console.error('Error:', error));
}

function handleIngredientChange(event) {
    if (event.target.matches("select[name='icode']")) {
        updateIngredientType(event.target);
    }
}

function updateIngredientType(select) {
    const row = select.closest('tr');
    const typeInput = row.querySelector("input[name='type']");
    fetch(`/getTypeByIcode?icode=${select.value}`)
        .then(response => response.json())
        .then(data => { typeInput.value = data.type; })
        .catch(error => console.error('Error:', error));
}

function handleIngredientDelete(event) {
    if (event.target.matches('.ingredient-delete-btn')) {
        event.target.closest('tr').remove();
    }
}

function addIngredient() {
    const table = document.getElementById('ingredient-table');
    const newRow = createIngredientRow();
    table.appendChild(newRow);
}

function createIngredientRow() {
	const newRow = document.createElement('tr');
    newRow.innerHTML = `
        <th>재료 정보</th>
        <td>
            <select name="icode">
                <option value="0">재료 이름</option>
                ${ingredientsList.map(ingredient => 
                    `<option value="${ingredient.icode}">${ingredient.name}</option>`
                ).join('')}
            </select>
        </td>
        <td><input type="text" name="amount" placeholder="수량"></td>
        <td><input type="text" name="type" placeholder="단위(개/g)"></td>
        <td><span class="ingredient-delete-btn">X</span></td>
    `;

    // 새로 생성된 행에 이벤트 리스너 추가
    const newSelect = newRow.querySelector('select[name="icode"]');
    addChangeListener(newSelect);

    const newDeleteBtn = newRow.querySelector('.ingredient-delete-btn');
    addDeleteEvent(newDeleteBtn);

    return newRow;
}

function handleRecipeStepEvents(event) {
    if (event.target.matches('.order-img')) {
        handleImageUpload(event.target);
    } else if (event.target.matches('.delete-btn')) {
        handleStepDelete(event.target);
    }
}

function handleImageUpload(orderImgCell) {
    const imageInput = orderImgCell.querySelector('input[type="file"]');
    const imageDisplay = orderImgCell.querySelector('img');
    const imageInText = orderImgCell.querySelector(".order-img-text");
    
    // 이미지와 텍스트 모두에 클릭 이벤트 추가
    orderImgCell.addEventListener('click', function(e) {
        if (e.target === this || e.target === imageInText || e.target === imageDisplay) {
            imageInput.click();
        }
    });
    
    imageInput.addEventListener('change', function() {
        if (this.files && this.files[0]) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                imageDisplay.src = e.target.result;
                imageDisplay.style.display = 'block';
                imageInText.style.display = 'none';
            };
            
            reader.readAsDataURL(this.files[0]);
        }
    });
}

function handleStepDelete(deleteBtn) {
    deleteBtn.closest('tr').remove();
    updateStepNumbers();
}

function addRecipeOrder() {
    const table = document.getElementById("recipe-steps");
    const stepNumber = table.rows.length + 1;
    const newRow = createRecipeOrderRow(stepNumber);
    table.appendChild(newRow);
    handleImageUpload(newRow.querySelector('.order-img'));
    updateStepNumbers();
}

function createRecipeOrderRow(stepNumber, existingImageUrl = '') {
    const newRow = document.createElement('tr');
    newRow.innerHTML = `
        <th>Step ${stepNumber}
            <input type="hidden" name="orderNum" value="${stepNumber}">
        </th>
        <td>
            <textarea name="orderContent[${stepNumber - 1}]" placeholder="예) 소고기를 숭덩숭덩 썰어주세요"></textarea>
        </td>
        <td class="order-img">
            <p class="order-img-text" ${existingImageUrl ? 'style="display:none;"' : ''}>➕</p>
            <input type="file" name="newCookingImg[${stepNumber - 1}]" accept="image/*" style="display:none;">
            <input type="hidden" name="existingCookingImg[${stepNumber - 1}]" value="${existingImageUrl}">
            <img src="${existingImageUrl || '/img/imgNone.png'}" style="${existingImageUrl ? '' : 'display:none;'}">
        </td>
        <td>
            <span class="delete-btn">X</span>
        </td>
    `;
    return newRow;
}

function updateStepNumbers() {
    const rows = document.querySelectorAll('#recipe-steps tr');
    rows.forEach((row, index) => {
        const stepNum = index + 1;
        const stepCell = row.querySelector('th');
        const orderNumInput = stepCell.querySelector('input[name="orderNum"]');
        const textArea = row.querySelector('textarea');
        const fileInput = row.querySelector('input[type="file"]');
        
        stepCell.firstChild.textContent = `Step ${stepNum}`;
        orderNumInput.value = stepNum;
        textArea.name = `orderContent[${index}]`;
        if (fileInput) {
            fileInput.name = `cookingImg[${index}]`;
        }
    });
}

function setupOrderImages() {
    document.querySelectorAll('.order-img').forEach((cell, index) => {
        const img = cell.querySelector('img');
        const textElem = cell.querySelector('.order-img-text');
        const fileInput = cell.querySelector('input[type="file"]');
        
        if (img.src && !img.src.endsWith('imgNone.png')) {
            textElem.style.display = 'none';
            img.style.display = 'block';
        } else {
            textElem.style.display = 'block';
            img.style.display = 'none';
        }

        fileInput.name = `cookingImg[${index}]`;
        handleImageUpload(cell);
    });
}

function loadMenuImage(mcode) {
    fetch(`/getMenuImage?mcode=${mcode}`)
        .then(response => response.json())
        .then(data => {
            document.getElementById("menu-image").src = `/uploads/${data.imgurl}`;
        })
        .catch(error => console.error("Error:", error));
}

function createIngredientRow() {
    const newRow = document.createElement('tr');
    newRow.innerHTML = `
        <th>재료 정보</th>
        <td>
            <select name="icode">
                <option value="0">재료 이름</option>
                <option value="1">레몬</option>
                <option value="2">칠면조고기</option>
                <option value="3">대파</option>
                <option value="4">쪽파</option>
                <option value="5">생강</option>
                <option value="6">마늘</option>
                <option value="7">감자</option>
                <option value="8">당근</option>
                <option value="9">브로콜리</option>
                <option value="10">배추</option>
                <option value="11">시금치</option>
                <option value="12">애호박</option>
                <option value="13">오이</option>
                <option value="14">토마토</option>
                <option value="15">피망</option>
                <option value="16">상추</option>
                <option value="17">양배추</option>
                <option value="18">호박</option>
                <option value="19">콜리플라워</option>
                <option value="20">무</option>
                <option value="21">파프리카</option>
                <option value="22">소고기</option>
                <option value="23">돼지고기</option>
                <option value="24">닭고기</option>
                <option value="25">오리고기</option>
                <option value="26">양고기</option>
                <option value="27">명태</option>
                <option value="28">고등어</option>
                <option value="29">연어</option>
                <option value="30">새우</option>
                <option value="31">굴</option>
                <option value="32">양송이 버섯</option>
                <option value="33">호두</option>
                <option value="34">아몬드</option>
                <option value="35">땅콩</option>
                <option value="36">파인애플</option>
                <option value="37">바나나</option>
                <option value="38">사과</option>
                <option value="39">딸기</option>
                <option value="40">포도</option>
                <option value="41">수박</option>
                <option value="42">옥수수</option>
                <option value="43">검은콩</option>
                <option value="44">완두콩</option>
                <option value="45">고구마</option>
                <option value="46">청경채</option>
                <option value="47">무화과</option>
                <option value="48">블루베리</option>
                <option value="49">참외</option>
                <option value="50">키위</option>
                <option value="51">깻잎</option>
                <option value="52">고추</option>
                <option value="53">가지</option>
                <option value="54">양파</option>
            </select>
        </td>
        <td><input type="text" name="amount" placeholder="수량"></td>
        <td><input type="text" name="type" placeholder="단위(개/g)"></td>
        <td><span class="ingredient-delete-btn">X</span></td>
    `;
    return newRow;
}

function createRecipeOrderRow(stepNumber, existingImageUrl = '') {
    const newRow = document.createElement('tr');
    newRow.innerHTML = `
        <th>Step ${stepNumber}
            <input type="hidden" name="orderNum" value="${stepNumber}">
        </th>
        <td>
            <textarea name="orderContent[${stepNumber - 1}]" placeholder="예) 소고기를 숭덩숭덩 썰어주세요"></textarea>
        </td>
        <td class="order-img">
            <p class="order-img-text">➕</p>
            <input type="file" name="newCookingImg[${stepNumber - 1}]" accept="image/*" style="display:none;">
            <input type="hidden" name="existingCookingImg[${stepNumber - 1}]" value="${existingImageUrl}">
            <img src="${existingImageUrl || '/img/imgNone.png'}" style="${existingImageUrl ? '' : 'display:none;'}">
        </td>
        <td>
            <span class="delete-btn">X</span>
        </td>
    `;
    return newRow;
}

document.querySelector('form').addEventListener('submit', function(e) {
    e.preventDefault();
    console.log("Form data:", new FormData(this));
    this.submit();
});

</script>






</body>
</html>