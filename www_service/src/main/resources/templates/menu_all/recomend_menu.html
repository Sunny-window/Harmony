<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>날씨 기반 메뉴 추천</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .weather-container {
            padding: 20px;
            margin-top: 20px;
            border-radius: 8px;
            text-align: center;
        }
        .weather-item {
            font-size: 16px;  
        }
        .weather-icon {
            font-size: 20px;
            margin: 0 5px; 
            vertical-align: middle; 
        }
        .menu-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 20px;
        }
        .menu-item {
            width: 200px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .menu-item:nth-child(1) { background-color: #ffb3ba; }
        .menu-item:nth-child(2) { background-color: #baffc9; }
        .menu-item:nth-child(3) { background-color: #bae1ff; }
        .menu-item:nth-child(4) { background-color: #ffffba; }
        .menu-item img {
            width: 100%;
            height: 150px;
            object-fit: cover;
        }
        .menu-info {
            padding: 15px;
            text-align: center;
        }
        .menu-name {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .menu-button {
            background-color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
        }
    </style>
</head>
<body>

<section>
    <div id="weather-container" class="weather-container">
    </div>
    <h1>현재 날씨에 이런 메뉴 어때요?</h1>
    <div id="menu-list" class="menu-list">
    </div>
</section>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const apiKey = '5ec2a8343328554022efe9f92a7fdfa3';
        const cityName = 'Busan';
        const url = `http://api.openweathermap.org/data/2.5/weather?q=${cityName}&appid=${apiKey}`;

        const weatherMapping = {
            'clear sky': '맑음',
            'few clouds': '맑음',
            'scattered clouds': '맑음',
            'broken clouds': '흐림',
            'overcast clouds': '흐림',
            'light rain': '비',
            'moderate rain': '비',
            'heavy intensity rain': '비',
            'shower rain': '비',
            'rain': '비',
            'thunderstorm': '비',
            'snow': '눈',
            'mist': '안개',
            'fog': '안개',
            'haze': '안개',
            'smoke': '안개',
            'dust': '안개',
            'sand': '안개',
            'ash': '안개',
            'squalls': '비',
            'tornado': '비'
        };

        const weatherIcons = {
            '맑음': '☀️',
            '흐림': '☁️',
            '비': '🌧️',
            '눈': '❄️',
            '안개': '🌫️'
        };

        const menuImages = {
            '라멘': 'ramen.jpg',
            '오뎅': '오뎅사진.png',
            '짬뽕': 'jjamppong.png',
            '딤섬': 'dim_sum.png',
            '돈부리': 'donburi.jpg',
            '소바': 'soba.jpg',
            '스테이크': 'steak.png',
            '삼계탕': 'samgyetang.png',
            '하이라이스': 'hayashi_rice.png',
            '와플': 'waffles.png',
            '동태찌개': 'dongtae_jjigae.png',
            '호박죽': 'hobak_juk.png'
        };

        fetch(url)
            .then(response => response.json())
            .then(data => {
                const weatherContainer = document.getElementById('weather-container');
                const date = new Date(data.dt * 1000);
                const formattedDate = date.toISOString().split('T')[0];
                const temp = (data.main.temp - 273.15).toFixed(2);
                const description = data.weather[0].description;
                const simplifiedDescription = weatherMapping[description] || '맑음';
                const icon = weatherIcons[simplifiedDescription] || '☀️';

                const content = `
                    <div class="weather-item">
                        ${temp}°C <span class="weather-icon">${icon}</span> ${simplifiedDescription}
                    </div>
                `;

                weatherContainer.innerHTML = content;

                // 온도에 따른 메뉴 추천
                let recommendedMenus;
                if (temp < 26) {
                    recommendedMenus = ['라멘', '오뎅', '짬뽕', '딤섬'];
                } else if (temp >= 26 && temp < 27) {
                    recommendedMenus = ['돈부리', '소바', '스테이크', '삼계탕'];
                } else {
                    recommendedMenus = ['하이라이스', '와플', '동태찌개', '호박죽'];
                }

                const menuList = document.getElementById('menu-list');
                menuList.innerHTML = recommendedMenus.map(menu => `
                    <div class="menu-item">
                        <img src="/uploads/${menuImages[menu] || 'default.jpg'}" alt="${menu}">
                        <div class="menu-info">
                            <div class="menu-name">${menu}</div>
                        </div>
                    </div>
                `).join('');
            })
            .catch(error => console.error('Error fetching weather data:', error));
    });

    
</script>
</body>
</html>